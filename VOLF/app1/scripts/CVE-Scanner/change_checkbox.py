import os
import sys
import django
from datetime import date, timedelta

sys.path.append(os.path.dirname(os.path.abspath(__file__)) + '/../../../')
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'VOLF.settings')
django.setup()

from app1.models import VulnerabilityFound

def update_vulnerabilities():
    yesterday = date.today() - timedelta(days=1)
    last_records = VulnerabilityFound.objects.order_by('-id')[:20]
    
    for record in last_records:
        if record.date <= yesterday:
            record.verified = True
            record.save()

update_vulnerabilities()
